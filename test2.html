<!DOCTYPE html>
<html>
<head>
    <title>Convert JSON Data to HTML Table</title>
    <style>
        #map {
			width: 55%;
			height: 6000px;
			float:left;
		}
        #info {
			width: 45%;
			height: 6000px;
			float:left;
            position: relative;
		} 
        #weather {
            width: 100%;
			height: 60px;
            position: relative;
        }
        #table1 {
			width: 20%;
			height: 80px;
			float:left;
            position: relative;
        }
        #table2 {
			width: 20%;
			height: 50px;
			float:left;
            position: relative;
        }
        #desc2 {
			width: 100%;
			height: 22px;
            margin: 20px;
			float:left;
            font: 13px Arial, Helvetica, sans-serif;
            color: #7a7474;
            position: relative;
		}
        th, td, {
            font:15px 'Segoe UI';
        }
        table, th, td {
            border: solid 1px #ddd;
            border-collapse: collapse;
            padding: 2px 3px;
            text-align: center;
            margin: 5px;
        }
        th {
            font-weight:bold;
        }

    </style>
</head>
<body>
    <div id="map"></div>

    <div id = "info">
        <div id = "desc2">
            <p><b>Some data about the weather at this location now:</b></p>
        </div>
    
        <div id="weather">
            <div id='table1'></div>
            <div style = 'float:left'>
                <img src="compass.jpg" alt="Compass image" width="100px" style="margin-left:35%;margin-top:5%">
            </div>
        </div>

        <div id = "desc2">
            <p><b>Past shark attacks in the region:</b></p>
        </div>
    
        <div id='table2'></div>    

    </div>

</body>

<script>
        var weather_data =
                {
                    "time": "2022-02-17T17:00:00+00:00",
                    "waveDirection": {
                        "noaa": 273.04
                    },
                    "waveHeight": {
                        "noaa": 0.91
                    },
                    "windDirection": {
                        "noaa": 91.55
                    },
                    "windSpeed": {
                        "noaa": 0.53
                    }
                }

        var table_weather = document.createElement("table");

        // add json data to the table as rows.
        for (const [key, value] of Object.entries(weather_data)) {
            if (key !== "time"){
                var th = document.createElement("th");      // table header.
                th.innerHTML = key;

                // Create table header row using the extracted headers above.
                var tr = table_weather.insertRow(-1);                   // table row.
                tr.appendChild(th);
                var tabCell = tr.insertCell(-1);
                tabCell.innerHTML =  Object.values(value);
            }          
        }   

        // Now, add the newly created table with json data, to a container.
        var divShowData = document.getElementById('table1');
        divShowData.innerHTML = "";
        divShowData.appendChild(table_weather);

        var sharks_data = 
        {
            "type": "FeatureCollection",
            "features": [
                {
                    "id": 4,
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -158.036483727,
                            21.48343645
                        ]
                    },
                    "properties": {
                        "Date": "03/05/2021",
                        "Time": " 3:30 pm",
                        "Shark": "Requiem shark, length 5-6 feet",
                        "Activity": "Surfing",
                        "Location": "Oahu",
                        "full_location": "Oahu, Kaneohe",
                        "Location_attack": " Kaneohe",
                        "Location_attack2": " North Beach",
                        "Location_attack3": " approx 10 yds from shore"
                    }
                },
                {
                    "id": 17,
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -158.036483727,
                            21.48343645
                        ]
                    },
                    "properties": {
                        "Date": "18/09/2019",
                        "Time": " 10:10 am",
                        "Shark": "Galapagos shark, length 5-9 feet.",
                        "Activity": "Swimming with sharks",
                        "Location": "Oahu",
                        "full_location": "Oahu, Haleiwa",
                        "Location_attack": " Haleiwa",
                        "Location_attack2": " approx 3 miles from shore",
                        "Location_attack3": null
                    }
                },
                {
                    "id": 18,
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -158.036483727,
                            21.48343645
                        ]
                    },
                    "properties": {
                        "Date": "18/09/2019",
                        "Time": " 10:10 am",
                        "Shark": "Galapagos shark, length 5-9 feet.",
                        "Activity": "Swimming with sharks",
                        "Location": "Oahu",
                        "full_location": "Oahu, Haleiwa",
                        "Location_attack": " Haleiwa",
                        "Location_attack2": " approx 3 miles from shore",
                        "Location_attack3": null
                    }
                },
                {
                    "id": 19,
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -158.036483727,
                            21.48343645
                        ]
                    },
                    "properties": {
                        "Date": "18/09/2019",
                        "Time": " 10:10 am",
                        "Shark": "Galapagos or sandbar, length unknown.",
                        "Activity": "Swimming with sharks",
                        "Location": "Oahu",
                        "full_location": "Oahu, Haleiwa",
                        "Location_attack": " Haleiwa",
                        "Location_attack2": " approx 3 miles from shore",
                        "Location_attack3": null
                    }
                },
                {
                    "id": 21,
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            -158.036483727,
                            21.48343645
                        ]
                    },
                    "properties": {
                        "Date": "11/08/2019",
                        "Time": " 7:00 pm",
                        "Shark": "Species and length unknown.",
                        "Activity": "Surfing",
                        "Location": "Oahu",
                        "full_location": "Oahu, Makaha Beach",
                        "Location_attack": " Makaha Beach",
                        "Location_attack2": " approx 100 yds from shore",
                        "Location_attack3": null
                    }
                }
            ]
        }

        var col = [];
        for (const properties of sharks_data.features){
            for (const key of Object.keys(properties.properties)){
                if (col.indexOf(key) === -1) {
                    col.push(key);
                }
            }
        };

        var table_sharks = document.createElement("table");
        var tr_sharks = table_sharks.insertRow(-1);                   // table row.

        for (var i = 0; i < col.length; i++) {
            var th_shark = document.createElement("th");      // TABLE HEADER.
            th_shark.innerHTML = col[i];
            tr_sharks.appendChild(th_shark);
        };
        console.log(col);           
        
        // ADD JSON DATA TO THE TABLE AS ROWS.
        for (const properties of sharks_data.features){
            for (const [key,value] of Object.entries(properties.properties)){
                // console.log(col)
                tr_sharks = table_sharks.insertRow(-1);
                
                 for (var j = 0; j < col.length; j++) {
                     var tabCell = tr_sharks.insertCell(-1);
                     tabCell.innerHTML = properties.properties[col[j]];
                 }
            }
        };

        // for (const properties of sharks_data.features){
        //     for (const [key,value] of Object.entries(properties.properties)){
        //         var th = document.createElement("th");      // table header.
        //         th.innerHTML = key;

        //         // Create table header row using the extracted headers above.
        //         var tr = table_sharks.insertRow(-1);                   // table row.
        //         tr.appendChild(th);
        //         var tabCell = tr.insertCell(-1);
        //         tabCell.innerHTML = value;
        //     }
        // };

        // var table_sharks = document.createElement("table_sharks"); //create table
        // var tr_sharks = table_sharks.insertRow(-1);                   // table row.

        // for (var i = 0; i < col.length; i++) {
        //     var th_shark = document.createElement("th_sharks");      // TABLE HEADER.
        //     th_shark.innerHTML = col[i];
        //     tr_sharks.appendChild(th);
        // };
        // console.log(th_shark);
        // console.log(tr_sharks);

        // // ADD JSON DATA TO THE TABLE AS ROWS.
        // for (const properties of sharks_data.features){
        //     for (const [key,value] of Object.entries(properties.properties)){

        //         tr_sharks = table_sharks.insertRow(-1);

        //         for (var j = 0; j < col.length; j++) {
        //             var tabCell = tr_sharks.insertCell(-1);
        //             tabCell.innerHTML = value;
        //         }
        //     }
        // };

        //         var th_shark = document.createElement("th");      // table header.
        //         th_shark.innerHTML = key;
        //         tr_sharks.appendChild(th_shark);

        //         var tr_sharks = table_sharks.insertRow(-1);
        //         tr_sharks = table_sharks.insertRow(-1);

        //         var tabCell = tr_sharks.insertCell(-1);
        //         tabCell.innerHTML = value;
        //     }
        // };

        // Now, add the newly created table with json data, to a container.
        var divShowData2 = document.getElementById('table2');
        divShowData2.innerHTML = "";
        divShowData2.appendChild(table_sharks);

</script>

</html>